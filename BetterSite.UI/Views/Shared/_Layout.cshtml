<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>@ViewBag.Title</title>
    <meta name="keywords" content="@ViewBag.Keywords,网站分享,网站推荐,实用的网站大全,优秀网站导航,优秀网站大全,互联网技术导航" />
    <meta name="description" content="@ViewBag.Description 优站分享,致力于分享实用的优秀网站,论坛,博客,官网,关注网站涵盖了互联网技术,软件开发,编程,框架,架构,开源,前端,设计,移动端,数据库,大数据,人工智能,机器学习等,是IT人工作,学习的最佳导航网站。" />
    @*@Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")*@
    @*<link href="~/Content/bootstrap_min.css" rel="stylesheet" />*@
    @Styles.Render("~/Content/bootstrap/css")
    <style type="text/css">
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
        }

        #container {
            min-height: 100%;
            height: auto !important;
            height: 100%; /*IE6不识别min-height*/
            position: relative;
            /*font-size:10px;*/
        }

        #page {
            margin: 0 auto;
            padding-bottom: 60px; /*等于footer的高度*/
        }

        #footer {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 60px; /*脚部的高度*/
            background: #f1f1f1;
            clear: both;
        }

        body {
            padding-top: 70px;
        }
      .navbar-inverse .navbar-nav > li > a {
        color: #c2c2c2;
    }
    </style>

</head>
<body>
    @{
        Html.RenderAction("_TypeCrtl", "Types");
    }
    <div id="container">
        <div id="page">
            @RenderBody()
        </div>
        <!-- 页脚  -->
        <div id="footer" class="text-center">
            <footer>
                <br/>
                优站分享,致力于分享实用的优秀网站
           <br/>
                Copyright © 2015-2017  <a href="http://www.isharesite.com/">IShareSite</a>.All Rights Reserved.               
            </footer>
        </div>
    </div>
        @Scripts.Render("~/bundles/jquery")
        @Scripts.Render("~/bundles/bootstrap")
        @Scripts.Render("~/bundles/common")
    @*@Scripts.Render("~/bundles/jqueryui")*@
    @RenderSection("scripts", required: false)
    <script>
        jQuery(function () {
            // debugger;
            //为标签绑定事件
            //jQuery('form [name=Tag]').each(function (i, elem) {
            //    elem.onchange = function () {
            //        jQuery('form').submit();
            //    };
            //});
            //为每个标签添加事件
           // debugger;
            // var urlFilename = (location.href.match(/\/([^\/]+)$/)[1]).split('?')[0];
            var localhrefmat = location.href.match(/\/([^\/]+)$/);
            if (localhrefmat) {
                var urlPath = localhrefmat[1];
                if (/SITE\d{13}/i.test(urlPath)) urlPath = '';//去掉SITE1489992926300
                var urlFilenameArr = urlPath.split('?');
                var urlFilename = '';
                debugger;
                if (urlFilenameArr.length == 2 && urlFilenameArr[1]) {
                    if (urlPath != 'Sites')
                        urlFilename = '/Sites/' + urlPath;
                    else
                        urlFilename = '/Sites/';
                    if (urlFilename.lastIndexOf('&') != (urlFilename.length - 1)) {
                        urlFilename += '&';
                    }
                } else {
                    if (urlFilenameArr[0] != 'Sites')
                        urlFilename = '/Sites/' + urlFilenameArr[0];
                    else
                        urlFilename = '/Sites/';
                    if (urlFilename==''||urlFilename.lastIndexOf('?') != (urlFilename.length - 1)) {
                        urlFilename += '?';
                    }
                }
                //debugger;
                //为每个站点的标签添加事件
                var paramValueArr = urlFilenameArr[1] ? urlFilenameArr[1].split('&') : [];
                var siteItemArr = jQuery('.li-site-item');
                jQuery.each(siteItemArr, function (i_site, n_site) {
                    var siteTagsName = jQuery(n_site).find('.hid-SiteTagsName').val();
                    //var siteTagsId = jQuery(n_site).find('.hid-SiteTagsId').val();
                    if (siteTagsName) {
                        var siteTagsNameArr = siteTagsName.split(',');
                        // var siteTagsIdArr = siteTagsId.split(',');
                        var htmlArr = [];
                        for (var i = 0; i < siteTagsNameArr.length; i++) {
                            if (paramValueArr.contains('Tag=' + encodeURI(siteTagsNameArr[i]))) {
                                // htmlArr.push('<a class="btn btn-default btn-xs disabled" href="' + urlFilename + 'Tag=' + siteTagsNameArr[i] + '">' + siteTagsNameArr[i] + '</a>');
                                htmlArr.push('<a class="btn btn-default btn-xs active" href="' + urlFilename.replace('Tag=' + encodeURI(siteTagsNameArr[i]) + '&', '') + '">' + siteTagsNameArr[i] + '</a>');
                            } else {
                                //htmlArr.push('<a class="btn btn-default btn-xs" href="' + urlFilename + 'TagId=' + siteTagsIdArr[i] + '">' + siteTagsNameArr[i] + '</a>');
                                htmlArr.push('<a class="btn btn-default btn-xs" href="' + urlFilename + 'Tag=' + siteTagsNameArr[i] + '">' + siteTagsNameArr[i] + '</a>');
                            }
                        }
                        jQuery(n_site).find('.div-SiteTags').append(htmlArr.join(' '));
                    }
                });
                ///为标签云添加事件
                jQuery('.Tag-Single').each(function (_i, _e) {
                    var _ej = jQuery(_e);
                    if (_ej.find('.active').length) {
                        _ej.children().attr('href', urlFilename.replace('Tag=' + encodeURI(_ej.children().text()) + '&', ''));
                    } else {
                        _ej.children().attr('href', urlFilename + 'Tag=' + encodeURI(_ej.children().text()));
                    }
                });
                ///活动菜单
                //var urlFilename = location.href.match(/\/([^\/]+)$/);
                if (urlFilenameArr[0]) {
                    $(".navbar li:has(a[href$='/Sites/" + urlFilenameArr[0] + "'])").addClass("active");
                }
            }

            //搜索辅助功能
            //jQuery('#SearchForm').keyup(function (e) {
            //    if (e.keyCode == 13) {
            var txt = decodeURI(Url.getParam('SearchText'));
            if (txt != 'undefined') { jQuery('#SearchForm').val(txt).focus(); }
                    ////Search();
                    //if (txt) {
                    //    jQuery('.li-site-item').css('display', 'none');
                    //    jQuery('.li-site-item:contains(' + txt + ')').css('display', 'block');
                    //} else {
                    //    jQuery('.li-site-item').css('display', 'block');
                    //}
                    //高亮显示
                    //jQuery('.li-site-item a').text().replace(txt, '<b>' + txt + '</b>');
            var site_a = jQuery('.li-site-item h4').children();//.text().replace(txt, '<b>' + txt + '</b>');
                   jQuery.each(site_a, function (i, n) {
                       //jQuery(n).html(jQuery(n).text().replace(txt, '&ltb&gt' + txt + '&lt/b&gt'));
                       jQuery(n).html(jQuery(n).text().replace(txt, '<mark>' + txt + '</mark>'));
                       //jQuery(n).next().html(jQuery(n).next().text().replace(txt, '<mark>' + txt + '</mark>'));
                   });
            //    }
            //});
            //搜索标签功能
                   jQuery('#SearchTag').keyup(function (e) {
                       if (e.keyCode == 13) {
                           var _this = jQuery(this);
                           $(".Tag-Single a").css('font-weight', 'normal');
                           var tagName = _this.val();
                           if (tagName) {
                               _this.next().css('display', 'none');
                               ///var exisTag = $(".Tag-Single label:contains('" + tagName + "')");
                               //if (exisTag.length) {
                               //    exisTag.css('font-weight', 'bold');
                               //    return;
                               //} else {
                               //    jQuery(this).next().css('display', 'initial');
                               //}
                              /// debugger;
                               var isn = false;
                               $(".Tag-Single a").each(function (i, e) {
                                   if (jQuery(e).text().toLowerCase().indexOf(tagName.toLowerCase()) > -1) {
                                       jQuery(e).css('font-weight', 'bold');
                                       isn = true;
                                   }
                               });
                               if (!isn) _this.next().css('display', 'initial');
                           }
                       }
                   });
            //站点添加时间显示样式
                   jQuery(".site-add-date").each(function (n, ele) {
                       if (ele.innerText.length > 0) {
                           ele.innerText = ele.innerText.substr(0, 11);
                       }
                   });
        });
    </script>
    <script>
        //百度自动推送
        (function () {
            var bp = document.createElement('script');
            var curProtocol = window.location.protocol.split(':')[0];
            if (curProtocol === 'https') {
                bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
            }
            else {
                bp.src = 'http://push.zhanzhang.baidu.com/push.js';
            }
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(bp, s);
        })();

        //百度统计
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?5f86045996483139413748abc268c7f6";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
</body>

</html>
