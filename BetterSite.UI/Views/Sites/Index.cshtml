@{
    ViewBag.Title = "优站分享|致力于分享实用的优秀网站";
}
@model IList<BetterSite.Domain.M_Sites>
<style>
     .gjlist {
        border-bottom: 1px dotted #ccc;
        clear: both;
        overflow: hidden;
        width: 100%;
        padding: 15px 0;
    }
    .gjlist .pic {
        float: left;
        width: 200px;
        margin: 10px 0 0 30px;
    }

    .gjlist .incon {
        float: right;
        width: 420px;
    }
 .gjlist h2 {
            position: relative;
            width: 99%;
            margin-top: 2px;
            font-size: 16px;
            margin-bottom: 0px;
            /*padding-bottom:0px;*/
        }
   .gjlist p {
        /*line-height: 150%;*/
        margin:0px;
        padding:0px;
        color: #666;
        /*margin-top: 20px;*/
        font-size: 12px;
         text-indent: 26px;
    }
     .gjlist p.l {
            color: #999;
        }
    .fl {
        float: left;
    }  
    .fr {
        float: right;
    }
    .gjlist h2 span {    
        background: url('../../Images/eye.jpg')0 4px no-repeat;
        padding-left: 23px;
        color: #fd7658;
        position: absolute;
        right: 0;
    }
            .title {
        width: 340px;
        display: block;
        overflow: hidden;
        word-break: keep-all;
        white-space: nowrap;
        text-overflow: ellipsis;
        float:left;
        text-decoration:none;
        color:#666;
    }
    .title:hover{
         text-decoration:underline;
        color:#62bee3;
    }
    .gjlist p.siteprofile {
           height: 84px;

    }
     p.siteprofile > span > a {
            color:#666;

    }
    .visit img{
    margin-left:5px;
 
    }
</style>
@foreach (var item in Model)
{
    <div class="gjlist">
        <div class="pic">
            <a href="/Sites/@item.SiteCode" target="_blank" title="@item.SiteName"> 
                <img src="~/Images/SiteScreen\@{@item.SiteCode}.jpg" alt="@item.SiteName" title="@item.SiteName" width="190" />
            </a>
        </div>
        <div class="incon">
            <h2 class="fl">
                <a class="title" href="/Sites/@item.SiteCode" target="_blank" title="@item.SiteUrl"> @item.SiteName</a>
                <span>@item.SiteClickQuantity</span>        
               
            </h2>
            <p>类别:<a href="/@item.TypeCode/1.html" target="_self" title="@item.TypeName">@item.TypeName</a></p>
            <p class="siteprofile">
                @if (item.SiteProfile != null) {
                @Html.Raw(item.SiteProfile.Length > 130 ? item.SiteProfile.Substring(0, 130) : item.SiteProfile);
                }...
                <span><a href="/Sites/@item.SiteCode" target="_blank" title="更多网站介绍">更多</a></span>
                @*<span>[<a href="/Sites/@item.SiteCode" target="_blank" title="直达官方网站 &#10; @item.SiteUrl">直达</a>]</span>*@
                <a href="@item.SiteUrl" class="visit" target="_blank" rel="nofollow">
                    <img src="~/Content/images/visit.png" style="border: none;"  width="14" height="14" alt="icon" title="直达官方网站 &#10; @item.SiteUrl">
                </a>
               
            </p>
            <p class="l fl div-SiteTags">               
                标签:              
            </p>
            <input type="hidden" class="hid-SiteTagsName" value="@item.SiteTagsName" />
            <p class="l fr site-add-date">@item.SiteAddDate</p>
        </div>
    </div>
    @*<div class="article">
            <div class="pic">
                <img src="~\Images\SiteScreen\@{@item.SiteCode}.jpg" alt="@item.SiteName" title="@item.SiteName" width="156" />
            </div>
            <div class="incon">


                <h2><span>@item.SiteName</span></h2><div class="clr"></div>
                <p><span class="site-add-date"><a href="#">@item.SiteAddDate</a></span> &nbsp;|&nbsp; <a href="/Sites/@item.TypeCode" target="_self" title="@item.TypeName">@item.TypeName</a></p>

                <p>
                    @Html.Raw(item.SiteProfile)
                </p>
                <div class="div-SiteTags" style="display:inline; margin:6px auto -3px 30px;"></div>
                <input type="hidden" class="hid-SiteTagsName" value="@item.SiteTagsName" />
                <p class="spec1">
                    <a href="#" class="com"><span>11</span> Comments</a>
                    <a href="/Sites/@item.SiteCode" target="_blank" title="@item.SiteUrl" class="rm">Read more &raquo;</a>
                </p>
            </div>
        </div>*@
}
<p class="pages">
    <small>Page @ViewBag.Page of @ViewBag.PageCount</small>
     <a href="">&laquo;</a> 
    <a href="">&raquo;</a>
</p>
@*<form method="get" action="">
    <p class="pages"> <a href="#">&laquo;</a> <a href="#">&raquo;</a></p>
    <input type="text" name="page"/>
    <input type="submit" value="提交" />
</form>*@
@section Scripts
    {
    <script>
        jQuery(function () {         
            //分页
            var page= @ViewBag.Page;
            var pageCount=@ViewBag.PageCount;
            jQuery('.pages a').css('display','none');
            if(page>1){
                jQuery('.pages a:first').css('display','inline');
                jQuery('.pages a:first').attr('href',location.href.replace(/\d{1,5}\.html/ ,(-1+page)+'.html'));
            }
            if(page< pageCount){ 
                jQuery('.pages a:last').css('display','inline');
                jQuery('.pages a:last').attr('href',location.href.replace(/\d{1,5}\.html/ ,(1+page)+'.html'));
            }
            //jQuery(".new-site a").each(function (n, ele) {
            //    // if ((ele.innerText.replace(/[^\x00-\xff]/, 'aa')).length > 12) {  //一个全角字符2个长度
            //    if ((ele.innerText).length > 12) {
            //        // ele.innerText = ele.innerText.substr(0, 12) + '..';
            //        ele.innerText = ele.innerText.substring(0, 12) + '..';
            //    }
            //});
            //debugger;
            //为每个站点的标签添加事件
            var urlFilename = location.href;
            var urlarr=  location.pathname.split('/');
            urlarr.pop();
            urlarr.push('1.html');
            var siteItemArr = jQuery('.gjlist');
            jQuery.each(siteItemArr, function (i_site, n_site) {
                var siteTagsName = jQuery(n_site).find('.hid-SiteTagsName').val();
                if (siteTagsName) {
                    var siteTagsNameArr = siteTagsName.split(',');
                    var htmlArr = [];
                   
                    for (var i = 0; i < siteTagsNameArr.length; i++) {
                        if(urlarr.length==3){//插入
                            urlarr.splice(2,0,siteTagsNameArr[i]);   
                            htmlArr.push('<a href="' + urlarr.join('/') + '"><span>' + siteTagsNameArr[i] + '</span></a>');
                        } else  if(urlarr.length==4){//修改
                            urlarr.splice(2,1,siteTagsNameArr[i]);
                            htmlArr.push('<a href="' + urlarr.join('/') + '"><span>' + siteTagsNameArr[i] + '</span></a>');
                        }     
                    }                   
                    jQuery(n_site).find('.div-SiteTags').append(htmlArr.join(' '));
                }
            });
            //分页
        })
    </script>
}